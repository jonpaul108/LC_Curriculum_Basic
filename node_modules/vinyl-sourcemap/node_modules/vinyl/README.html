<p>&lt;p align=&quot;center&quot;&gt;
&lt;a href=&quot;http://gulpjs.com&quot;&gt;
&lt;img height=&quot;257&quot; width=&quot;114&quot; src=&quot;https://raw.githubusercontent.com/gulpjs/artwork/master/gulp-2x.png&quot;&gt;
&lt;/a&gt;
&lt;/p&gt;</p>
<h1>vinyl</h1>
<p><a href="https://www.npmjs.com/package/vinyl"><img src="https://img.shields.io/npm/v/vinyl.svg" alt="NPM version"></a> <a href="https://www.npmjs.com/package/vinyl"><img src="https://img.shields.io/npm/dm/vinyl.svg" alt="Downloads"></a> <a href="https://dev.azure.com/gulpjs/gulp/_build/latest?definitionId=$PROJECT_ID&amp;branchName=master"><img src="https://dev.azure.com/gulpjs/gulp/_apis/build/status/vinyl?branchName=master" alt="Azure Pipelines Build Status"></a> <a href="https://travis-ci.org/gulpjs/vinyl"><img src="https://img.shields.io/travis/gulpjs/vinyl.svg?label=travis-ci" alt="Travis Build Status"></a> <a href="https://ci.appveyor.com/project/gulpjs/vinyl"><img src="https://img.shields.io/appveyor/ci/gulpjs/vinyl.svg?label=appveyor" alt="AppVeyor Build Status"></a> <a href="https://coveralls.io/r/gulpjs/vinyl"><img src="https://img.shields.io/coveralls/gulpjs/vinyl/master.svg" alt="Coveralls Status"></a> <a href="https://gitter.im/gulpjs/gulp"><img src="https://badges.gitter.im/gulpjs/gulp.svg" alt="Gitter chat"></a></p>
<p>Virtual file format.</p>
<h2>What is Vinyl?</h2>
<p>Vinyl is a very simple metadata object that describes a file. When you think of a file, two attributes come to mind: <code>path</code> and <code>contents</code>. These are the main attributes on a Vinyl object. A file does not necessarily represent something on your computerâ€™s file system. You have files on S3, FTP, Dropbox, Box, CloudThingly.io and other services. Vinyl can be used to describe files from all of these sources.</p>
<h2>What is a Vinyl Adapter?</h2>
<p>While Vinyl provides a clean way to describe a file, we also need a way to access these files. Each file source needs what I call a &quot;Vinyl adapter&quot;. A Vinyl adapter simply exposes a <code>src(globs)</code> and a <code>dest(folder)</code> method. Each return a stream. The <code>src</code> stream produces Vinyl objects, and the <code>dest</code> stream consumes Vinyl objects. Vinyl adapters can expose extra methods that might be specific to their input/output medium, such as the <code>symlink</code> method <a href="https://github.com/gulpjs/vinyl-fs"><code>vinyl-fs</code></a> provides.</p>
<h2>Usage</h2>
<pre><code class="language-js">var Vinyl = require('vinyl');

var jsFile = new Vinyl({
  cwd: '/',
  base: '/test/',
  path: '/test/file.js',
  contents: Buffer.from('var x = 123')
});
</code></pre>
<h2>API</h2>
<h3><code>new Vinyl([options])</code></h3>
<p>The constructor is used to create a new instance of <code>Vinyl</code>. Each instance represents a separate file, directory or symlink.</p>
<p>All internally managed paths (<code>cwd</code>, <code>base</code>, <code>path</code>, <code>history</code>) are normalized and have trailing separators removed. See <a href="#normalization-and-concatenation">Normalization and concatenation</a> for more information.</p>
<p>Options may be passed upon instantiation to create a file with specific properties.</p>
<h4><code>options</code></h4>
<p>Options are not mutated by the constructor.</p>
<h5><code>options.cwd</code></h5>
<p>The current working directory of the file.</p>
<p>Type: <code>String</code></p>
<p>Default: <code>process.cwd()</code></p>
<h5><code>options.base</code></h5>
<p>Used for calculating the <code>relative</code> property. This is typically where a glob starts.</p>
<p>Type: <code>String</code></p>
<p>Default: <code>options.cwd</code></p>
<h5><code>options.path</code></h5>
<p>The full path to the file.</p>
<p>Type: <code>String</code></p>
<p>Default: <code>undefined</code></p>
<h5><code>options.history</code></h5>
<p>Stores the path history. If <code>options.path</code> and <code>options.history</code> are both passed, <code>options.path</code> is appended to <code>options.history</code>. All <code>options.history</code> paths are normalized by the <code>file.path</code> setter.</p>
<p>Type: <code>Array</code></p>
<p>Default: <code>[]</code> (or <code>[options.path]</code> if <code>options.path</code> is passed)</p>
<h5><code>options.stat</code></h5>
<p>The result of an <code>fs.stat</code> call. This is how you mark the file as a directory or symbolic link. See <a href="#isdirectory">isDirectory()</a>, <a href="#issymbolic">isSymbolic()</a> and <a href="http://nodejs.org/api/fs.html#fs_class_fs_stats">fs.Stats</a> for more information.</p>
<p>Type: <a href="http://nodejs.org/api/fs.html#fs_class_fs_stats"><code>fs.Stats</code></a></p>
<p>Default: <code>undefined</code></p>
<h5><code>options.contents</code></h5>
<p>The contents of the file.  If <code>options.contents</code> is a <a href="https://nodejs.org/api/stream.html#stream_readable_streams"><code>ReadableStream</code></a>, it is wrapped in a <a href="https://github.com/mcollina/cloneable-readable"><code>cloneable-readable</code></a> stream.</p>
<p>Type: <a href="https://nodejs.org/api/stream.html#stream_readable_streams"><code>ReadableStream</code></a>, <a href="https://nodejs.org/api/buffer.html#buffer_class_buffer"><code>Buffer</code></a>, or <code>null</code></p>
<p>Default: <code>null</code></p>
<h5><code>options.{custom}</code></h5>
<p>Any other option properties will be directly assigned to the new Vinyl object.</p>
<pre><code class="language-js">var Vinyl = require('vinyl');

var file = new Vinyl({ foo: 'bar' });
file.foo === 'bar'; // true
</code></pre>
<h3>Instance methods</h3>
<p>Each Vinyl object will have instance methods. Every method will be available but may return differently based on what properties were set upon instantiation or modified since.</p>
<h4><code>file.isBuffer()</code></h4>
<p>Returns <code>true</code> if the file contents are a <a href="https://nodejs.org/api/buffer.html#buffer_class_buffer"><code>Buffer</code></a>, otherwise <code>false</code>.</p>
<h4><code>file.isStream()</code></h4>
<p>Returns <code>true</code> if the file contents are a <a href="https://nodejs.org/api/stream.html#stream_stream"><code>Stream</code></a>, otherwise <code>false</code>.</p>
<h4><code>file.isNull()</code></h4>
<p>Returns <code>true</code> if the file contents are <code>null</code>, otherwise <code>false</code>.</p>
<h4><code>file.isDirectory()</code></h4>
<p>Returns <code>true</code> if the file represents a directory, otherwise <code>false</code>.</p>
<p>A file is considered a directory when:</p>
<ul>
<li><code>file.isNull()</code> is <code>true</code></li>
<li><code>file.stat</code> is an object</li>
<li><code>file.stat.isDirectory()</code> returns <code>true</code></li>
</ul>
<p>When constructing a Vinyl object, pass in a valid <a href="http://nodejs.org/api/fs.html#fs_class_fs_stats"><code>fs.Stats</code></a> object via <code>options.stat</code>. If you are mocking the <a href="http://nodejs.org/api/fs.html#fs_class_fs_stats"><code>fs.Stats</code></a> object, you may need to stub the <code>isDirectory()</code> method.</p>
<h4><code>file.isSymbolic()</code></h4>
<p>Returns <code>true</code> if the file represents a symbolic link, otherwise <code>false</code>.</p>
<p>A file is considered symbolic when:</p>
<ul>
<li><code>file.isNull()</code> is <code>true</code></li>
<li><code>file.stat</code> is an object</li>
<li><code>file.stat.isSymbolicLink()</code> returns <code>true</code></li>
</ul>
<p>When constructing a Vinyl object, pass in a valid <a href="http://nodejs.org/api/fs.html#fs_class_fs_stats"><code>fs.Stats</code></a> object via <code>options.stat</code>. If you are mocking the <a href="http://nodejs.org/api/fs.html#fs_class_fs_stats"><code>fs.Stats</code></a> object, you may need to stub the <code>isSymbolicLink()</code> method.</p>
<h4><code>file.clone([options])</code></h4>
<p>Returns a new Vinyl object with all attributes cloned.</p>
<p><strong>By default custom attributes are cloned deeply.</strong></p>
<p>If <code>options</code> or <code>options.deep</code> is <code>false</code>, custom attributes will not be cloned deeply.</p>
<p>If <code>file.contents</code> is a <a href="https://nodejs.org/api/buffer.html#buffer_class_buffer"><code>Buffer</code></a> and <code>options.contents</code> is <code>false</code>, the <a href="https://nodejs.org/api/buffer.html#buffer_class_buffer"><code>Buffer</code></a> reference will be reused instead of copied.</p>
<h4><code>file.inspect()</code></h4>
<p>Returns a formatted-string interpretation of the Vinyl object. Automatically called by node's <code>console.log</code>.</p>
<h3>Instance properties</h3>
<p>Each Vinyl object will have instance properties. Some may be unavailable based on what properties were set upon instantiation or modified since.</p>
<h4><code>file.contents</code></h4>
<p>Gets and sets the contents of the file. If set to a <a href="https://nodejs.org/api/stream.html#stream_readable_streams"><code>ReadableStream</code></a>, it is wrapped in a <a href="https://github.com/mcollina/cloneable-readable"><code>cloneable-readable</code></a> stream.</p>
<p>Throws when set to any value other than a <a href="https://nodejs.org/api/stream.html#stream_readable_streams"><code>ReadableStream</code></a>, a <a href="https://nodejs.org/api/buffer.html#buffer_class_buffer"><code>Buffer</code></a> or <code>null</code>.</p>
<p>Type: <a href="https://nodejs.org/api/stream.html#stream_readable_streams"><code>ReadableStream</code></a>, <a href="https://nodejs.org/api/buffer.html#buffer_class_buffer"><code>Buffer</code></a>, or <code>null</code></p>
<h4><code>file.cwd</code></h4>
<p>Gets and sets current working directory. Will always be normalized and have trailing separators removed.</p>
<p>Throws when set to any value other than non-empty strings.</p>
<p>Type: <code>String</code></p>
<h4><code>file.base</code></h4>
<p>Gets and sets base directory. Used for relative pathing (typically where a glob starts).
When <code>null</code> or <code>undefined</code>, it simply proxies the <code>file.cwd</code> property. Will always be normalized and have trailing separators removed.</p>
<p>Throws when set to any value other than non-empty strings or <code>null</code>/<code>undefined</code>.</p>
<p>Type: <code>String</code></p>
<h4><code>file.path</code></h4>
<p>Gets and sets the absolute pathname string or <code>undefined</code>. Setting to a different value appends the new path to <code>file.history</code>. If set to the same value as the current path, it is ignored. All new values are normalized and have trailing separators removed.</p>
<p>Throws when set to any value other than a string.</p>
<p>Type: <code>String</code></p>
<h4><code>file.history</code></h4>
<p>Array of <code>file.path</code> values the Vinyl object has had, from <code>file.history[0]</code> (original) through <code>file.history[file.history.length - 1]</code> (current). <code>file.history</code> and its elements should normally be treated as read-only and only altered indirectly by setting <code>file.path</code>.</p>
<p>Type: <code>Array</code></p>
<h4><code>file.relative</code></h4>
<p>Gets the result of <code>path.relative(file.base, file.path)</code>.</p>
<p>Throws when set or when <code>file.path</code> is not set.</p>
<p>Type: <code>String</code></p>
<p>Example:</p>
<pre><code class="language-js">var file = new File({
  cwd: '/',
  base: '/test/',
  path: '/test/file.js'
});

console.log(file.relative); // file.js
</code></pre>
<h4><code>file.dirname</code></h4>
<p>Gets and sets the dirname of <code>file.path</code>. Will always be normalized and have trailing separators removed.</p>
<p>Throws when <code>file.path</code> is not set.</p>
<p>Type: <code>String</code></p>
<p>Example:</p>
<pre><code class="language-js">var file = new File({
  cwd: '/',
  base: '/test/',
  path: '/test/file.js'
});

console.log(file.dirname); // /test

file.dirname = '/specs';

console.log(file.dirname); // /specs
console.log(file.path); // /specs/file.js
</code></pre>
<h4><code>file.basename</code></h4>
<p>Gets and sets the basename of <code>file.path</code>.</p>
<p>Throws when <code>file.path</code> is not set.</p>
<p>Type: <code>String</code></p>
<p>Example:</p>
<pre><code class="language-js">var file = new File({
  cwd: '/',
  base: '/test/',
  path: '/test/file.js'
});

console.log(file.basename); // file.js

file.basename = 'file.txt';

console.log(file.basename); // file.txt
console.log(file.path); // /test/file.txt
</code></pre>
<h4><code>file.stem</code></h4>
<p>Gets and sets stem (filename without suffix) of <code>file.path</code>.</p>
<p>Throws when <code>file.path</code> is not set.</p>
<p>Type: <code>String</code></p>
<p>Example:</p>
<pre><code class="language-js">var file = new File({
  cwd: '/',
  base: '/test/',
  path: '/test/file.js'
});

console.log(file.stem); // file

file.stem = 'foo';

console.log(file.stem); // foo
console.log(file.path); // /test/foo.js
</code></pre>
<h4><code>file.extname</code></h4>
<p>Gets and sets extname of <code>file.path</code>.</p>
<p>Throws when <code>file.path</code> is not set.</p>
<p>Type: <code>String</code></p>
<p>Example:</p>
<pre><code class="language-js">var file = new File({
  cwd: '/',
  base: '/test/',
  path: '/test/file.js'
});

console.log(file.extname); // .js

file.extname = '.txt';

console.log(file.extname); // .txt
console.log(file.path); // /test/file.txt
</code></pre>
<h4><code>file.symlink</code></h4>
<p>Gets and sets the path where the file points to if it's a symbolic link. Will always be normalized and have trailing separators removed.</p>
<p>Throws when set to any value other than a string.</p>
<p>Type: <code>String</code></p>
<h3><code>Vinyl.isVinyl(file)</code></h3>
<p>Static method used for checking if an object is a Vinyl file. Use this method instead of <code>instanceof</code>.</p>
<p>Takes an object and returns <code>true</code> if it is a Vinyl file, otherwise returns <code>false</code>.</p>
<p><strong>Note: This method uses an internal flag that some older versions of Vinyl didn't expose.</strong></p>
<p>Example:</p>
<pre><code class="language-js">var Vinyl = require('vinyl');

var file = new Vinyl();
var notAFile = {};

Vinyl.isVinyl(file); // true
Vinyl.isVinyl(notAFile); // false
</code></pre>
<h3><code>Vinyl.isCustomProp(property)</code></h3>
<p>Static method used by Vinyl when setting values inside the constructor or when copying properties in <code>file.clone()</code>.</p>
<p>Takes a string <code>property</code> and returns <code>true</code> if the property is not used internally, otherwise returns <code>false</code>.</p>
<p>This method is useful for inheritting from the Vinyl constructor. Read more in <a href="#extending-vinyl">Extending Vinyl</a>.</p>
<p>Example:</p>
<pre><code class="language-js">var Vinyl = require('vinyl');

Vinyl.isCustomProp('sourceMap'); // true
Vinyl.isCustomProp('path'); // false -&gt; internal getter/setter
</code></pre>
<h2>Normalization and concatenation</h2>
<p>Since all properties are normalized in their setters, you can just concatenate with <code>/</code>, and normalization takes care of it properly on all platforms.</p>
<p>Example:</p>
<pre><code class="language-js">var file = new File();
file.path = '/' + 'test' + '/' + 'foo.bar';

console.log(file.path);
// posix =&gt; /test/foo.bar
// win32 =&gt; \\test\\foo.bar
</code></pre>
<p>But never concatenate with <code>\</code>, since that is a valid filename character on posix system.</p>
<h2>Extending Vinyl</h2>
<p>When extending Vinyl into your own class with extra features, you need to think about a few things.</p>
<p>When you have your own properties that are managed internally, you need to extend the static <code>isCustomProp</code> method to return <code>false</code> when one of these properties is queried.</p>
<pre><code class="language-js">var Vinyl = require('vinyl');

var builtInProps = ['foo', '_foo'];

class SuperFile extends Vinyl {
  constructor(options) {
    super(options);
    this._foo = 'example internal read-only value';
  }

  get foo() {
    return this._foo;
  }

  static isCustomProp(name) {
    return super.isCustomProp(name) &amp;&amp; builtInProps.indexOf(name) === -1;
  }
}

// `foo` won't be assigned to the object below
new SuperFile({ foo: &quot;something&quot; });
</code></pre>
<p>This makes properties <code>foo</code> and <code>_foo</code> skipped when passed in options to <code>constructor(options)</code> so they don't get assigned to the new object and override your custom implementation. They also won't be copied when cloning. <strong>Note:</strong> The <code>_foo</code> and <code>foo</code> properties will still exist on the created/cloned object because you are assigning <code>_foo</code> in the constructor and <code>foo</code> is defined on the prototype.</p>
<p>Same goes for <code>clone()</code>. If you have your own internal stuff that needs special handling during cloning, you should extend it to do so.</p>
<h2>License</h2>
<p>MIT</p>
